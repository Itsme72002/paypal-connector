/**
 * Mule S3 Cloud Connector
 *
 * Copyright (c) MuleSoft, Inc.  All rights reserved.  http://www.mulesoft.com
 *
 * The software in this package is published under the terms of the CPAL v1.0
 * license, a copy of which has been included with this distribution in the
 * LICENSE.txt file.
 */

/**
 * This file was automatically generated by the Mule Cloud Connector Development Kit
 */
package org.mule.module.paypal;

import static org.mockito.Matchers.*;
import static org.mockito.Mockito.*;
import junit.framework.Assert;

import org.junit.Before;
import org.junit.Test;
import org.mockito.Mockito;

import ebay.api.paypalapi.AddressVerifyResponseType;
import ebay.api.paypalapi.DoCaptureResponseType;
import ebay.api.paypalapi.GetBalanceResponseType;
import ebay.apis.corecomponenttypes.BasicAmountType;
import ebay.apis.eblbasecomponents.CompleteCodeType;
import ebay.apis.eblbasecomponents.CountryCodeType;
import ebay.apis.eblbasecomponents.CurrencyCodeType;
import ebay.apis.eblbasecomponents.MatchStatusCodeType;

public class PaypalTestCase
{
    private PaypalCloudConnector connector;
    private PaypalFacade facade;
    
    @Before
    public void before() 
    {
        facade = Mockito.mock(PaypalFacade.class);
        connector = new PaypalCloudConnector();
        connector.setFacade(facade);
    }
    
    @Test
    public void getBalanceTest()
    {
        final GetBalanceResponseType ret = new GetBalanceResponseType();
        boolean returnAllCurrencies = Boolean.TRUE;
        Mockito.when(facade.getBalance(returnAllCurrencies)).thenReturn(ret);
        Assert.assertEquals(ret, connector.getBalance(returnAllCurrencies));
    }
    
    @Test
    public void addressVerifyTest() 
    {
        final AddressVerifyResponseType ret = new AddressVerifyResponseType();
        final String email = "xxx@xxxxx.com";
        final String street = "Street";
        final String zip = "562";
        ret.setStreetMatch(MatchStatusCodeType.MATCHED);
        ret.setCountryCode(CountryCodeType.US);
        Mockito.when(facade.addressVerify(email, street, zip)).thenReturn(ret);
        Assert.assertEquals(ret, connector.addressVerify(email, street, zip));
    }

    @Test
    public void captureTest() 
    {
        final String authorizationId = "111111";
        final Boolean complete = Boolean.TRUE;
        final String value = "150.25";
        final CurrencyCodeType currency = CurrencyCodeType.USD;
        final DoCaptureResponseType ret = new DoCaptureResponseType();
        
        
        final CompleteCodeType completeCode = CompleteCodeType.COMPLETE;
        final BasicAmountType amount = new BasicAmountType();
        amount.setValue(value);
        amount.setCurrencyID(currency);
        
        when(facade.capture(eq(authorizationId), eq(completeCode),
                                    refEq(amount), (String) isNull(), 
                                    (String) isNull(), (String) isNull()))
                                    .thenReturn(ret);
        
        Assert.assertEquals(ret, connector.capture(authorizationId, complete, 
                                            value, currency, null, null, null));
        
    }
    
}
